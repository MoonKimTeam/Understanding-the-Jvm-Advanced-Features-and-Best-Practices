# 3.7 적합한 가비지 컬렉터 선택하기

## 엡실론 컬렉터

- 가비지 컬렉션을 전혀 하지 않는 컬렉터(실제로 그렇지는 않음)
- 자동 메모리 관리 서브 시스템
- 가비지 컬렉터는 힙 관리, 레이아웃, 객체 할당, 인터프리터, 컴파일러, 모니터링 서브 시스템 연동 등 수행
- 용도: 가비지 컬렉터를 서브시스템으로부터 떼어놓기, GC 배제 성능 테스트나 부하 테스트, 마이크로서비스나 서버리스용(저메모리, JIT 최적화 배제)
- 단기 동작 애플리케이션에서는 동작 부하가 아주 적고 메모리 회수 활동을 전혀 하지 않기 때문에 안성맞춤

## 컬렉터들 간 비교 및 취사선택

- 컬렉터 선택 시 고려 요소
    - 애플리케이션 주목적
        - 무엇이 중요한지(처리량, SLA, 지연시간, 메모리 사용량 등)
    - 애플리케이션 구동 서브시스템(아키텍처, 프로세서 개수, 가용 메모리 용량, 운영체제 등)
    - JDK 제공자
- Oracle JDK 또는 OpenJDK 이용 시 선택 방법
    - 최대 100MB 이하 작은 데이터만 다루는 경우 -> 시리얼
    - 단일 프로세서, 일시 정지시간 제약 없는 경우 -> 시리얼
    - 최대 성능 중요, 지연 시간 제약 없거나 1초 이상 지연 시간 허용되는 경우 -> 기본, 패러렐
    - 처리량보다 응답 시간 중요, 일시 정시 시간 짧아야 하는 경우 -> G1
    - 응답 시간 매우 중요 -> (세대 구분) ZGC

## 가상 머신과 가비지 컬렉터 로그

- 메모리 문제를 다루려면, 가상 머신과 가비지 컬렉터의 로그를 읽고 분석할 수 있어야 함
- JDK 9부터 -Xlog 매개 변수로 모든 핫스팟 기능의 로그를 설정할 수 있게 됨
- 로그 형식, 로그를 보고 싶은 기능 모듈, 로그 레벨, 데커레이터 등은 책 참조

## 가비지 컬렉터 매개 변수 정리

![img_4.png](img_4.png)

![img_5.png](img_5.png)